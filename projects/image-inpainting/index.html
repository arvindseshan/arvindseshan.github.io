<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Image Inpainting | Arvind Seshan </title> <meta name="author" content="Arvind Seshan"> <meta name="description" content="Designed and implemented process for inpainting regions in images by interpolating structure (image gradients) using a Poisson solver and color values via PDE’s (anisotropic diffusion) in &lt;code&gt;C++&lt;/code&gt;."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?2b978e4a8990396e7582116c8c5bb12b"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://arvindseshan.github.io/projects/image-inpainting/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8.0.6/dist/styles.min.css" integrity="sha256-3qTIuuUWIFnnU3LpQMjqiXc0p09rvd0dmj+WkpQXSR8=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/venobox@2.1.8/dist/venobox.min.css" integrity="sha256-ohJEB0/WsBOdBD+gQO/MGfyJSbTUI8OOLbQGdkxD6Cg=" crossorigin="anonymous"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Arvind</span> Seshan </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/photos/">travel photos </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <i class="ti ti-search" id="search-button"></i> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Image Inpainting</h1> <p class="post-tags"> <i class="fa-solid fa-hashtag fa-sm"></i> C/C++   <i class="fa-solid fa-hashtag fa-sm"></i> visual-computing   ·   <i class="fa-solid fa-tag fa-sm"></i> class-projects </p> </header> <article class="post-content"> <div id="markdown-content"> <p>For this project, I designed and implemented process for inpainting regions in images by interpolating structure (image gradients) using a Poisson solver and color values via PDE’s (anisotropic diffusion) in <code>C++</code>.</p> <p>With the recent popularity of generative AI (diffusion models) for a variety of visual tasks including inpainting, the goal was to take a deeper dive into classical methods for image inpainting.</p> <h2 id="poisson-solver">Poisson Solver</h2> <p>The first step for this project was to implement a Poisson solver. Below, you can see a test case that runs the Poisson solver for seamless compositing given a background (water), foreground (bear), and mask. The blended result is shown in the bottom right image.</p> <div class="social"> <a class="venobox" data-gall="myGallery" href="../../../assets/img/waterpool.png"><img style=" border-radius: 5%;vertical-align:middle;margin:2px 2px" src="../../../assets/img/waterpool.png"></a> <a class="venobox" data-gall="myGallery" href="../../../assets/img/mask.png"><img style=" border-radius: 5%;vertical-align:middle;margin:2px 2px" src="../../../assets/img/mask.png"></a><br> <a class="venobox" data-gall="myGallery" href="../../../assets/img/bear.png"><img style=" border-radius: 5%;vertical-align:middle;margin:2px 2px" src="../../../assets/img/bear.png"></a> <a class="venobox" data-gall="myGallery" href="../../../assets/img/poissonTest.png"><img style=" border-radius: 5%;vertical-align:middle;margin:2px 2px" src="../../../assets/img/poissonTest.png"></a> </div> <h2 id="laplacian">Laplacian</h2> <p>Next, I had to compute the Laplacian of an image. The test case below runs the code to compute the Laplacian by convolving with the appropriate kernel. Drag the slider on the image to reveal the original image and its corresponding Laplacian. The Laplacian is a second derivative and should highlight regions of the image with drastic changes in pixel intensity (i.e. edges).</p> <div class="social"> <img-comparison-slider> <figure slot="first"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/beach-480.webp 480w,/assets/img/beach-800.webp 800w,/assets/img/beach-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/beach.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure slot="second"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/applyLaplacianTest-480.webp 480w,/assets/img/applyLaplacianTest-800.webp 800w,/assets/img/applyLaplacianTest-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/applyLaplacianTest.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </img-comparison-slider> </div> <h2 id="structure-tensor">Structure Tensor</h2> <p>I also compute the structure tensor of an image. The test case below runs the code to compute the structure tensor while ignoring pixels within the masked area. Drag the slider on the image to reveal the original image with the mask and its corresponding structure tensor. The red and blue coloring indicates a change in intensity in primarily the horizontal and vertical directions respectively. Also, note how the tensor output is correctly blacked out in the masked regions.</p> <div class="social"> <img-comparison-slider> <figure slot="first"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/street_with_mask-480.webp 480w,/assets/img/street_with_mask-800.webp 800w,/assets/img/street_with_mask-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/street_with_mask.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure slot="second"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/tensorMaskTest-480.webp 480w,/assets/img/tensorMaskTest-800.webp 800w,/assets/img/tensorMaskTest-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/tensorMaskTest.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </img-comparison-slider> </div> <h2 id="structure-interpolation">Structure Interpolation</h2> <p>With these components, the next step is to interpolate the structure of the masked regions. To do this, I first compute the structure tensor outside the masked area. Then, I run the Poisson solver with the initial structure tensor as the background and a black image as the foreground. The test case below runs the code to interpolate the structure tensor within the masked area of the image. The image on the left is the full structure tensor output and the image on the right depicts just the interpolated parts in the masked region.</p> <div class="social"> <img-comparison-slider> <figure slot="first"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/InterpolateStructureTestStreet-480.webp 480w,/assets/img/InterpolateStructureTestStreet-800.webp 800w,/assets/img/InterpolateStructureTestStreet-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/InterpolateStructureTestStreet.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure slot="second"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/InterpolateStructureTestMaskStreet-480.webp 480w,/assets/img/InterpolateStructureTestMaskStreet-800.webp 800w,/assets/img/InterpolateStructureTestMaskStreet-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/InterpolateStructureTestMaskStreet.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </img-comparison-slider> </div> <h2 id="color-interpolation">Color Interpolation</h2> <p>Now that I have an interpolated structure tensor, I can use it to interpolate color values within the masked area. To do this, I iterate over the image and perform iterative image inpainting updates. I interleave these updates with a pass of anisotropic diffusion every third iteration. I only update pixels within the masked region. Below are the results of the algorithm on a few sample images.</p> <div class="social"> <img-comparison-slider> <figure slot="first"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/street_with_mask-480.webp 480w,/assets/img/street_with_mask-800.webp 800w,/assets/img/street_with_mask-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/street_with_mask.png" class="img-fluid rounded z-depth-1" width="300" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure slot="second"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/AnisotropicDiffusionTestStreet-480.webp 480w,/assets/img/AnisotropicDiffusionTestStreet-800.webp 800w,/assets/img/AnisotropicDiffusionTestStreet-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/AnisotropicDiffusionTestStreet.png" class="img-fluid rounded z-depth-1" width="300" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </img-comparison-slider> <img-comparison-slider> <figure slot="first"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/inpaintingbeach-480.webp 480w,/assets/img/inpaintingbeach-800.webp 800w,/assets/img/inpaintingbeach-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/inpaintingbeach.png" class="img-fluid rounded z-depth-1" width="300" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure slot="second"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/inpaintingbeach2-480.webp 480w,/assets/img/inpaintingbeach2-800.webp 800w,/assets/img/inpaintingbeach2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/inpaintingbeach2.png" class="img-fluid rounded z-depth-1" width="300" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </img-comparison-slider> </div> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Arvind Seshan. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8.0.6/dist/index.min.js" integrity="sha256-EXHg3x1K4oIWdyohPeKX2ZS++Wxt/FRPH7Nl01nat1o=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/venobox@2.1.8/dist/venobox.min.js" integrity="sha256-LsGXHsHMMmTcz3KqTaWvLv6ome+7pRiic2LPnzTfiSo=" crossorigin="anonymous"></script> <script defer src="/assets/js/venobox-setup.js?897c1d9c0b6fcf82b949511c1609d055" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>